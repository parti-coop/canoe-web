.panel.panel-warning[proposal_request]
  .panel-heading
    %h4.panel-title
      = byline proposal_request.user
      \-
      = proposal_request.title

  %ul.list-group
    - proposal_request.proposals.each do |proposal|
      %li.list-group-item
        .media
          .media-body
            %h5= proposal.title
            .text-muted
              = proposal.user.nickname
              = link_to '삭제', proposal, method: :delete, data: { confirm: '정말 삭제하시겠습니까?' }, class: 'text-danger'
              %a{"data-toggle": "collapse", href: "##{dom_id(proposal)}__voted_users", role: "button", class: 'text-muted'}
                %i.fa.fa-users
                = proposal.votes.count
              .collapse{id: "#{dom_id(proposal)}__voted_users"}
                %ul.list-unstyled
                  %li
                    = Vote.choice.agree.text
                    = render partial: 'users/byline', collection: proposal.agreeing_users, as: :user
                  %li
                    = Vote.choice.block.text
                    = render partial: 'users/byline', collection: proposal.blocking_users, as: :user

          - if can? :vote, proposal
            .media-right
              = link_to agree_proposal_path(proposal), method: :post, class: 'btn btn-default' do
                %i.fa.fa-thumbs-o-up
                = proposal.agree_votes_count
              = link_to block_proposal_path(proposal), method: :post, class: 'btn btn-default' do
                %i.fa.fa-ban
                = proposal.block_votes_count
    %li.list-group-item
      = form_for Proposal.new do |f|
        = f.hidden_field :proposal_request_id, value: proposal_request.id
        .media-left
          = render 'users/thumbnail', user: current_user
        .media-body
          .form-group
            = f.text_field :title, placeholder: '새로운 제안을 남기세요', class: 'form-control'
        .media-right
          .form-group
            = f.submit '추가', class: 'btn btn-primary'

